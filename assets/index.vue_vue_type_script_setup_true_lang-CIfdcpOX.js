
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as b,r as h,p as F,q as I,aq as N,ar as O,c as k,g as f,F as g,Q as S,v as K,j as P,a6 as L,as as Q,M as T,l as U,s as E}from"./index-D8kZ2dnq.js";import{r as W,_ as j}from"./item.vue_vue_type_script_setup_true_lang-DveDsvPI.js";import{_ as D}from"./sub.vue_vue_type_script_setup_true_lang-DkFuZ_hh.js";const X=b({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1}},setup(z){const n=z,M=new WeakMap;function r(e){return M.has(e)||M.set(e,Q()),M.get(e)}const s=h(n.value),o=h({}),c=h({}),t=h(n.defaultOpeneds.slice(0)),A=h([]),y=F(()=>n.mode==="horizontal"||n.mode==="vertical"&&n.collapse);function q(e,l=[]){e.forEach(a=>{var v,d;const u=(v=a.path)!=null?v:r(a);if((d=a.children)!=null&&d.some(i=>{var p;return((p=i.meta)==null?void 0:p.menu)!==!1})){const i=[...l,u];c.value[u]={index:u,indexPath:i,active:!1},q(a.children,i)}else o.value[u]={index:u,indexPath:l}})}const _=(e,l)=>{t.value.includes(e)||(n.accordion&&(t.value=t.value.filter(a=>l.includes(a))),t.value.push(e))},m=e=>{if(Array.isArray(e)){T(()=>{m(e.at(-1)),e.length>1&&m(e.slice(0,-1))});return}t.value=t.value.filter(l=>l!==e)};function w(e){var l,a;for(const u in c.value)c.value[u].active=!1;(l=c.value[e])==null||l.indexPath.forEach(u=>{c.value[u].active=!0}),(a=o.value[e])==null||a.indexPath.forEach(u=>{c.value[u].active=!0})}const x=e=>{(n.mode==="horizontal"||n.collapse)&&(t.value=[]),w(e)},$=(e,l)=>{t.value.includes(e)?m(e):_(e,l)};function C(){const e=s.value&&o.value[s.value];w(s.value),!(!e||y.value||n.collapse)&&e.indexPath.forEach(l=>{const a=c.value[l];a&&_(l,a.indexPath)})}return I(()=>n.menu,e=>{q(e),C()},{deep:!0,immediate:!0}),I(()=>n.value,e=>{o.value[e]||(s.value="");const l=o.value[e]||s.value&&o.value[s.value]||o.value[n.value];l?s.value=l.index:s.value=e,C()}),I(()=>n.collapse,e=>{e&&(t.value=[]),C()}),N(W,O({props:n,getUseId:r,items:o,subMenus:c,activeIndex:s,openedMenus:t,mouseInMenu:A,isMenuPopup:y,openMenu:_,closeMenu:m,handleMenuItemClick:x,handleSubMenuClick:$})),(e,l)=>(f(),k("div",{class:K(P(L)("h-full w-full flex flex-col of-hidden transition-all-300",{"flex-row w-auto":P(y)&&n.mode==="horizontal","py-1":n.mode==="vertical"}))},[(f(!0),k(g,null,S(e.menu,a=>{var u,v,d,i,p;return f(),k(g,{key:(u=a.path)!=null?u:r(a)},[((v=a.meta)==null?void 0:v.menu)!==!1?(f(),k(g,{key:0},[(d=a.children)!=null&&d.length?(f(),E(D,{key:0,menu:a,"unique-key":[(i=a.path)!=null?i:r(a)]},null,8,["menu","unique-key"])):(f(),E(j,{key:1,item:a,"unique-key":[(p=a.path)!=null?p:r(a)],onClick:G=>{var B;return x((B=a.path)!=null?B:r(a))}},null,8,["item","unique-key","onClick"]))],64)):U("",!0)],64)}),128))],2))}});export{X as _};
