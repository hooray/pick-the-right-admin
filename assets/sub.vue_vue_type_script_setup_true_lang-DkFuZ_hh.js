
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as E,at as S,au as L,p as y,c as g,g as c,e as _,s as v,l as M,j as n,w as F,am as j,v as B,a6 as b,F as C,Q as U,O as N,av as O,T as V,aw as W,A as Q,ax as T,M as Z}from"./index-D8kZ2dnq.js";import{_ as D,r as G}from"./item.vue_vue_type_script_setup_true_lang-DveDsvPI.js";const Y=E({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(K){var k;const s=K,w=S("itemRef"),x=S("subMenuRef"),t=L(G),f=(k=s.menu.path)!=null?k:t.getUseId(s.menu),H=y(()=>t.openedMenus.includes(s.uniqueKey.at(-1))),z=y(()=>t.isMenuPopup?{enter(e){e.offsetHeight>window.innerHeight&&(e.style.height="".concat(window.innerHeight,"px"))},afterEnter:()=>{},beforeLeave:e=>{e.style.maxHeight="".concat(e.offsetHeight,"px"),e.style.overflow="hidden"},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""}}:CSS.supports("height","calc-size(auto, size)")?{}:{enter(e){requestAnimationFrame(()=>{e.dataset.height=e.offsetHeight.toString(),e.style.maxHeight="0",e.offsetHeight,e.style.maxHeight="".concat(e.dataset.height,"px"),e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=""},enterCancelled(e){e.style.maxHeight="",e.style.overflow=""},beforeLeave(e){e.style.maxHeight="".concat(e.offsetHeight,"px"),e.style.overflow="hidden"},leave(e){e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""},leaveCancelled(e){e.style.maxHeight="",e.style.overflow=""}}),A=y(()=>t.isMenuPopup?{enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"}:{enterActiveClass:"ease-in-out duration-300",enterFromClass:b("opacity-0 translate-y-4 scale-95 blur-4",CSS.supports("height","calc-size(auto, size)")&&"h-0"),enterToClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveToClass:b("opacity-0 translate-y-4 scale-95 blur-4",CSS.supports("height","calc-size(auto, size)")&&"h-0")}),r=y(()=>{var e,a;return(a=(e=s.menu.children)==null?void 0:e.some(p=>{var l;return((l=p.meta)==null?void 0:l.menu)!==!1}))!=null?a:!1});function I(){var e;t.isMenuPopup&&r.value||(e=s.menu.meta)!=null&&e.link||requestAnimationFrame(()=>{r.value?t.handleSubMenuClick(f,s.uniqueKey):t.handleMenuItemClick(f)})}let u;function $(){t.isMenuPopup&&(t.mouseInMenu=s.uniqueKey,u==null||u(),{stop:u}=T(()=>{if(r.value)t.openMenu(f,s.uniqueKey),Z(()=>{requestAnimationFrame(()=>{var q,P;const e=(q=w.value)==null?void 0:q.ref,a=(P=x.value)==null?void 0:P.$el;if(!e||!a)return;const p=e.getBoundingClientRect(),{top:l,left:i,width:m,height:d}=p;let o=0,h=0;t.props.mode==="vertical"||s.level!==0?(o=l+e.scrollTop,h=i+m,o+a.offsetHeight>window.innerHeight&&(o=Math.max(0,window.innerHeight-a.offsetHeight))):(o=l+d,h=i,o+a.offsetHeight>window.innerHeight&&(a.style.height="".concat(window.innerHeight-o,"px"))),h+a.offsetWidth>document.documentElement.clientWidth&&(h=i-m),Object.assign(a.style,{top:"".concat(o,"px"),insetInlineStart:"".concat(h,"px"),willChange:"transform",transform:"translateZ(0)"})})});else{const e=s.menu.children?t.subMenus[f].indexPath.at(-1):t.items[f].indexPath.at(-1);t.openMenu(e,t.subMenus[e].indexPath)}},300))}function R(){t.isMenuPopup&&(t.mouseInMenu=[],u==null||u(),{stop:u}=T(()=>{requestAnimationFrame(()=>{t.mouseInMenu.length===0?t.closeMenu(s.uniqueKey):r.value&&!t.mouseInMenu.includes(s.uniqueKey.at(-1))&&t.closeMenu(s.uniqueKey.at(-1))})},300))}return(e,a)=>{const p=Q("SubMenu"),l=j;return c(),g(C,null,[_(D,{ref_key:"itemRef",ref:w,"unique-key":e.uniqueKey,item:e.menu,level:e.level,"sub-menu":n(r),expand:n(H),onClick:I,onMouseenter:$,onMouseleave:R},null,8,["unique-key","item","level","sub-menu","expand"]),n(r)?(c(),v(W,{key:0,to:"body",disabled:!n(t).isMenuPopup},[_(V,N(n(A),O(n(z))),{default:F(()=>[n(H)?(c(),v(l,{key:0,ref_key:"subMenuRef",ref:x,scrollbar:!1,mask:n(t).isMenuPopup,class:B(n(b)("sub-menu static h-[calc-size(auto,size)] rounded-lg will-change-transform",{"bg-[var(--g-sub-sidebar-bg)]":n(t).isMenuPopup,"border shadow-xl fixed z-3000 w-[200px]":n(t).isMenuPopup,"mx-1":n(t).isMenuPopup&&(n(t).props.mode==="vertical"||e.level!==0),"py-1":n(t).isMenuPopup}))},{default:F(()=>[(c(!0),g(C,null,U(e.menu.children,i=>{var m,d,o;return c(),g(C,{key:(m=i.path)!=null?m:n(t).getUseId(i)},[((d=i.meta)==null?void 0:d.menu)!==!1?(c(),v(p,{key:0,"unique-key":[...e.uniqueKey,(o=i.path)!=null?o:n(t).getUseId(i)],menu:i,level:e.level+1},null,8,["unique-key","menu","level"])):M("",!0)],64)}),128))]),_:1},8,["mask","class"])):M("",!0)]),_:1},16)],8,["disabled"])):M("",!0)],64)}}});export{Y as _};
